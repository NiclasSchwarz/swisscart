mox.require([ 'mox.DOM'],function(){mox.create('static mox.Event',{_domLoaded:[],_listeners:[],_cleanups:[],_domLoadedState:false,add:function(o,n,f,s){var ev=this,cb;if(!o)return null;o=mox.DOM.get(o);if(n=='init')n='DOMContentLoaded';cb=function(e){e=e||window.event;if(e&&!e.target)e.target=e.srcElement;if(!s)return f(e);return f.call(s,e);};if(mox.contentLoaded&&n=='DOMContentLoaded'){cb();return;}if((mox.isIE||mox.isSafari)&&n=='DOMContentLoaded'){this._domLoaded.push(cb);return cb;}this._listeners.push({obj:o,name:n,func:f,cfunc:cb,scope:s});this._addEvent(o,n,cb);return cb;},remove:function(o,n,f){var i,li=this._listeners,it;if(!o)return null;o=mox.DOM.get(o);this._removeEvent(o,n,f);for(i=0;i<li.length;i++){it=li[i];if(it.obj==o&&it.name==n&&it.func==f){this._removeEvent(it.obj,it.name,it.cfunc);li.splice(i,1);return f;}}return null;},removeAll:function(o){var i,li,it;for(i=0,li=this._listeners;i<li.length;i++){it=li[i];if(it.obj==o){this._removeEvent(it.obj,it.name,it.cfunc);li.splice(i,1);}}},cancel:function(e){var t=mox.Event;t.stopPropagation(e);return t.preventDefault(e);},stopPropagation:function(e){if(!e)return false;if(e.stopPropagation)e.stopPropagation();else e.cancelBubble=true;return false;},preventDefault:function(e){if(!e)return false;if(e.preventDefault)e.preventDefault();else e.returnValue=false;return false;},fire:function(o,n,e){var i,li,it;if(!e)return false;for(i=0,li=this._listeners;i<li.length;i++){it=li[i];if(it.obj==o&&it.name==n)it.cfunc(e);}return true;},getPageXY:function(e){var d=document,de=d.documentElement||d.body,x=e.pageX||e.clientX||0,y=e.pageY||e.clientY||0;if(mox.isIE){x+=de.scrollLeft;y+=de.scrollTop;}return{x:x,y:y};},addCleanup:function(f){this._cleanups.push(f);},_unLoad:function(){var i,ev=mox.Event,li,it,ex;for(i=0,li=ev._listeners;i<li.length;i++){it=li[i];try{ev._removeEvent(it.obj,it.name,it.cfunc);it.obj=it.name=it.cfunc=null;}catch(ex){}}for(i=0,li=ev._cleanups;i<li.length;i++){try{li[i]();}catch(ex){}}ev._removeEvent(window,'unload',ev._unLoad);ev._listeners=[];ev._cleanups=[];},_addEvent:function(o,n,f){if(o.attachEvent)o.attachEvent('on'+n,f);else if(o.addEventListener)o.addEventListener(n,f,false);else o['on'+n]=f;},_removeEvent:function(o,n,f){if(o.detachEvent)o.detachEvent('on'+n,f);else if(o.removeEventListener)o.removeEventListener(n,f,false);else o['on'+n]=null;},_DOMContentLoadedIE:function(){var e=document.getElementById('_ie_lo');if(e.readyState=="complete"){this._dispatchDOMContentLoaded();e.onreadystatechange=null;}},_dispatchDOMContentLoaded:function(){var i,ar=mox.Event._domLoaded;for(i=0;i<ar.length;i++)ar[i](window.event);mox.Event._domLoaded=[];mox.contentLoaded=true;},_waitForLoaded:function(){if (/loaded|complete/.test(document.readyState))this._dispatchDOMContentLoaded();else window.setTimeout('mox.Event._waitForLoaded();',10);},_handleDOMContentLoaded:function(d){d=!d?document:d;if(mox.isIE){try{document.execCommand('BackgroundImageCache',false,true);}catch(e){}}this._addEvent(window,'unload',this._unLoad);if(mox.isIE||mox.isSafari)this._waitForLoaded();}});mox.Event._handleDOMContentLoaded();});new function(){function isset(o){return typeof(o)!='undefined';};mox.create('static mox.List',{filter:function(a,f,si,ei){var i,o=[];si=isset(si)?si:0;ei=isset(ei)?ei:a.length;for(i=si;i<ei;i++){if(f(i,a[i]))o.push(a[i]);}return o;},map:function(a,f,si,ei){var i;si=isset(si)?si:0;ei=isset(ei)?ei:a.length;for(i=si;i<ei;i++)f(i,a[i]);},indexOf:function(a,v){var i;for(i=0;i<a.length;i++){if(a[i]==v)return i;}return-1;},each:function(a,f){var n,v;for(n in a){if((v=f(n,a[n])))return v;}return false;},getKeys:function(a){var o=[];this.each(a,function(n,v){o.push(n);});return o;},hasValue:function(a,rv){var s=0;this.each(a,function(n,v){return s=(v==rv);});return s;},remove:function(a,rv){return this.filter(a,function(i,v){return v!=rv;});}});};mox.require([ 'mox.List','mox.geom.Point','mox.geom.Rect'],function(){var List=mox.List;mox.create('mox.DOMUtils',{_counter:0,_doc:null,DOMUtils:function(doc){this._doc=doc;},selectElements:function(n,na,f){var i,a=[],nl,x;n=this.get(n);for(x=0,na=na.split(',');x<na.length;x++)for(i=0,nl=n.getElementsByTagName(na[x]);i<nl.length;i++)f(nl[i])&&a.push(nl[i]);return a;},select:function(p,s){var o=[],r=[],i,t=this,pl,ru,pu,x,u,xp;s=!s?this._doc.body:this.get(s);for(i=0,pl=p.split(',');i<pl.length;i++){ru=[];xp='.';for(x=0,pu=pl[i].split(' ');x<pu.length;x++){u=pu[x];if(u!=''){u=u.match(/^([\w\\]+)?(?:#([\w\\]+))?(?:\.([\w\\\.]+))?(?:\[\@([\w\\]+)([\^\$\*!]?=)([\w\\]+)\])?(?:\:([\w\\]+))?/i);if(document.evaluate){xp+=u[1]?'//'+u[1]:'//*';if(u[2])xp+="[@id='"+u[2]+"']";if(u[3]){List.each(u[3].split('.'),function(i,n){xp+="[@class = '"+n+"' or contains(concat(' ', @class, ' '), ' "+n+" ')]";});}if(u[4]){if(u[5]){if(u[5]=='^=')xp+="[starts-with(@"+u[4]+",'"+u[6]+"')]";else if(u[5]=='$=')xp+="[contains(concat(@"+u[4]+",'\0'),'"+u[6]+"\0')]";else if(u[5]=='*=')xp+="[contains(@"+u[4]+",'"+u[6]+"')]";else if(u[5]=='!=')xp+="[@"+u[4]+"!='"+u[6]+"']";}else xp+="[@"+u[4]+"='"+u[6]+"']";}}else ru.push({tag:u[1],id:u[2],cls:u[3]?new RegExp('\\b'+u[3].replace(/\./g,'|')+'\\b'):null,attr:u[4],val:u[5]});}}if(xp.length>1)ru.xpath=xp;r.push(ru);}function find(e,rl,p){var nl,i,n,ru=rl[p];for(i=0,nl=e.getElementsByTagName(!ru.tag?'*':ru.tag);i<nl.length;i++){n=nl[i];if(ru.id&&n.id!=ru.id)continue;if(ru.cls&&!ru.cls.test(n.className))continue;if(ru.attr&&t.getAttrib(n,ru.attr)!=ru.val)continue;if(p<rl.length-1)find(n,rl,p+1);else o.push(n);}};for(i=0;i<r.length;i++){if(r[i].xpath){ru=this._doc.evaluate(r[i].xpath,s,null,4,null);while(u=ru.iterateNext())o.push(u);}else find(s,r[i],0);}return o;},getViewPort:function(w){var d,b;w=!w?window:w;d=w.document;b=d.compatMode=='CSS1Compat'?d.documentElement:d.body;return new mox.geom.Rect(w.pageXOffset||b.scrollLeft,w.pageYOffset||b.scrollTop,w.innerWidth||b.clientWidth,w.innerHeight||b.clientHeight);},getParent:function(n,f,r){n=this.get(n);while(n){if(n==r)return null;if(f(n))return n;n=n.parentNode;}return null;},add:function(p,n,a,h){var t=this,e;e=this._doc.createElement(n);for(n in a){if(a.hasOwnProperty(n))t.setAttrib(e,n,a[n]);}if(h){if(h.nodeType)e.appendChild(h);else e.innerHTML=h;}return p?p.appendChild(e):e;},create:function(n,a,h){return this.add(0,n,a,h);},createTag:function(tn,a,h){var n,o=this._doc.createElement(tn);if(a){for(n in a){if(typeof(a[n])!='function'&&a[n]!=null){this.setAttrib(o,n,a[n]);}}}if(h)o.innerHTML=h;return o;},addTags:function(te,ne){var i,n;te=this.get(te);if(typeof(ne)=='string')te.appendChild(this._doc.createTextNode(ne));else if(ne.length){te=te.appendChild(this.createTag(ne[0],ne[1]));for(i=2;i<ne.length;i++)this.addTags(te,ne[i]);}},setAttrib:function(e,n,v){e=this.get(e);if(!e)return false;if(n=="style")e.style.cssText=v;if(n=="class")e.className=v;if(v!=null&&v!="")e.setAttribute(n,''+v);else e.removeAttribute(n);},setAttribs:function(e,o){var n;e=this.get(e);if(!e)return false;for(n in o){if(typeof(o[n])!='function')this.setAttrib(e,n,o[n]);}},getAttrib:function(e,n,dv){var v;e=this.get(e);if(!e)return false;if(typeof(dv)=="undefined")dv="";v=e.getAttribute(n,2);if(!v)v=e.attributes[n];if(n=="class"&&!v)v=e.className;if(n=="style"&&!v)v=e.style.cssText;return(v&&v!="")?v:dv;},setStyle:function(n,na,v){var s,i;if(!n)return false;n=typeof(n)=='string'?n.split(','):[n];for(i=0;i<n.length;i++){s=this.get(n[i]);if(!s)continue;s=s.style;na=na.replace(/-(\D)/g,function(a,b){return b.toUpperCase();});if(na=='opacity'){if(mox.isIE){s.filter="alpha(opacity="+(v * 100)+")";if(!n.currentStyle||!n.currentStyle.hasLayout)s.display='inline-block';}s['-moz-opacity']=s['-khtml-opacity']=v;}s[na]=v;}},setStyles:function(e,o){var n;if(!e)return false;for(n in o){if(typeof(o[n])!='function')this.setStyle(e,n,o[n]);}},getStyle:function(n,na,d){n=this.get(n);if(!n)return false;if(this._doc.defaultView){try{return this._doc.defaultView.getComputedStyle(n,null).getPropertyValue(na);}catch(n){return null;}}na=na.replace(/-(\D)/g,function(a,b){return b.toUpperCase();});if(n.currentStyle)return n.currentStyle[na];return false;},getByClass:function(n,na,c){var t=this;return this.selectElements(this.get(n),na,function(no){return t.hasClass(no,c);});},get:function(n){return typeof(n)=='string'?this._doc.getElementById(n):n;},show:function(id){this.setStyle(id,'display','block');},hide:function(id){this.setStyle(id,'display','none');},isHidden:function(id){return this.getStyle(id,'display')=='none';},setVisible:function(id,s){this.setStyle(id,'visibility',s?'visible':'hidden');return s;},isVisible:function(id){return this.getStyle(id,'visibility')=='visible';},getPos:function(n,ab,cn){var l=0,t=0,p,r,d;n=this.get(n);if(ab)return new mox.geom.Point(parseInt(this.getStyle(n,'left')),parseInt(this.getStyle(n,'top')));if(n&&n.getBoundingClientRect){r=n.getBoundingClientRect();d=document;n=d.compatMode=='CSS1Compat'?d.documentElement:d.body;return new mox.geom.Point(r.left+(n.scrollLeft||0),r.top+(n.scrollTop||0));}while(n&&n!=cn){l+=n.offsetLeft||0;t+=n.offsetTop||0;n=n.offsetParent;}return new mox.geom.Point(l,t);},getRect:function(e,ab,r){var p,r;e=this.get(e);p=this.getPos(e,ab);r=!r?new mox.geom.Rect():r;r.set(p.x,p.y,parseInt(this.getStyle(e,'width'))||e.offsetWidth,parseInt(this.getStyle(e,'height'))||e.offsetHeight);return r;},remove:function(id){var i,n;for(i=0,id=id.split(',');i<id.length;i++){n=this.get(id[i]);if(n)n.parentNode.removeChild(n);}},addClass:function(e,c,b){var o;e=this.get(e);if(!e)return null;o=this.removeClass(e,c);return e.className=b?c+(o!=''?(' '+o):''):(o!=''?(o+' '):'')+c;},removeClass:function(e,c){e=this.get(e);if(!e)return null;c=e.className.replace(new RegExp("(^|\\s+)"+c+"(\\s+|$)","g"),' ');return e.className=c!=' '?c:'';},replaceClass:function(e,o,n){if(this.hasClass(e,o)){this.removeClass(e,o);this.addClass(e,n);}},hasClass:function(n,c){n=this.get(n);return new RegExp('\\b'+c+'\\b','g').test(n.className);},getOuterHTML:function(e){var d;e=this.get(e);if(mox.isIE||mox.isOpera)return e.outerHTML;d=e.ownerDocument.createElement("body");d.appendChild(e.cloneNode(true));return d.innerHTML;},setOuterHTML:function(e,h){var i,nl,t;e=this.get(e);if(mox.isIE)e.outerHTML=h;else{t=e.ownerDocument.createElement("body");t.innerHTML=h;for(i=0,nl=t.childNodes;i<nl.length;i++)e.parentNode.insertBefore(nl[i].cloneNode(true),e);e.parentNode.removeChild(e);}},importCSS:function(css){var i,e,he,d=this._doc;css=css.split(',');for(i=0;i<css.length;i++){if(!d.createStyleSheet){e=d.createElement("link");e.rel="stylesheet";e.href=css[i];if((he=d.getElementsByTagName("head"))!=null&&he.length>0)he[0].appendChild(e);}else d.createStyleSheet(css[i]);}},uniqueId:function(p){return(!p?'mox_':p)+(this._counter++);}});mox.DOM=new mox.DOMUtils(document);mox.provide('mox.DOM');});mox.create('mox.geom.Point',{x:0,y:0,Point:function(x,y){this.x=x;this.y=y;},moveTo:function(x,y){this.x=x;this.y=y;},moveBy:function(x,y){this.x+=x;this.y+=y;},clone:function(){return new mox.geom.Point(this.x,this.y);}});mox.require([ 'mox.geom.Point'],function(){var Point=mox.geom.Point;mox.create('mox.geom.Rect:mox.geom.Point',{w:0,h:0,Rect:function(x,y,w,h){this.parent(x,y);this.w=w;this.h=h;},intersects:function(r){var i,p=new Point(0,0),c=['tl','tr','bl','br'];for(i=0;i<c.length;i++){p=this.getLocation(c[i],p);if(r.containsXY(p.x,p.y))return true;}return false;},containsXY:function(x,y){return x>=this.x&&x<=this.x+this.w&&y>=this.y&&y<=this.y+this.h;},contains:function(r){return this.x<=r.x&&this.y<=r.y&&this.x+this.w>=r.x+r.w&&this.y+this.h>=r.y+r.h;},getLocation:function(l,p){var v=l.charAt(0),h=l.charAt(1);p=!p?new Point(0,0):p;switch(v){case 't':p.y=this.y;break;case 'b':p.y=this.y+this.h;break;case 'c':p.y=this.y+(this.h/2);break;}switch(h){case 'l':p.x=this.x;break;case 'r':p.x=this.x+this.w;break;case 'c':p.x=this.x+(this.w/2);break;}return p;},resizeTo:function(w,h){this.w=w;this.h=h;},resizeBy:function(w,h){this.w+=w;this.h+=h;},set:function(x,y,w,h){this.x=x;this.y=y;this.w=w;this.h=h;},clone:function(){return new mox.geom.Rect(this.x,this.y,this.w,this.h);}});});mox.create('static mox.String',{_entities:{'&':'&amp;','"':'','\'' : '&#39;', '<' : '&lt;', '>' : '&gt;', '"' : '&quot;'},_xmlRe: /[<>&]/g,_xmlReQuot: /[<>&\"\']/g,xmlEncode:function(s,sq){var l=this._entities;return s?(''+s).replace(!sq?this._xmlReQuot:this._xmlRe,function(c,b){return l[c];}):s;},xmlDecode:function(s){var e=document.createElement("div");if(!s)return s;e.innerHTML=s;return e.firstChild.nodeValue;},stripTags:function(s){return!s?s:s.replace(/<[^>]+>/g,'');}});mox.require([ 'mox.DOM','mox.Event','mox.geom.Point','mox.geom.Rect','mox.List','mox.util.Dispatcher'],function(){var DOM=mox.DOM;var Event=mox.Event;var Point=mox.geom.Point;var Rect=mox.geom.Rect;var List=mox.List;var Dispatcher=mox.util.Dispatcher;mox.create('mox.dom.Drag:mox.dom.Layer',{settings:null,started:false,startPos:null,startRect:null,boundery:null,eventDocs:null,dropRects:null,hoverRect:null,Drag:function(t,s){var n,dr=this;this.parent(t,false);this.eventDocs=[document];this.settings={drag_handle:t,drop_points:'',ondrag:mox.bind(this,this.onDragEvent)};for(n in s)this.settings[n]=s[n];s=this.settings;this.setDropPoints(s.drop_points);List.map(s.drag_handle.split(','),function(i,v){Event.add(DOM.get(v),'mousedown',dr.onMouseDownDrag,dr);});this.onEnter=new Dispatcher(this);this.onLeave=new Dispatcher(this);this.onDragStart=new Dispatcher(this);this.onDragEnd=new Dispatcher(this);this.onDrag=new Dispatcher(this);this.onDrop=new Dispatcher(this);this.onOver=new Dispatcher(this);this.onMouseDown=new Dispatcher(this);},start:function(he){if(!this.started){this.updateRect();this.startRect=new Rect(this.x,this.y,this.w,this.h);this.addDocEvent('mousemove',this.onMouseMove,this);this.addDocEvent('mouseup',this.end,this);this.onDragStart.dispatch(he);this.started=true;}},end:function(){if(this.started){this.removeDocEvent('mousemove',this.onMouseMove,this);this.removeDocEvent('mouseup',this.end,this);this.onDragEnd.dispatch();if(this.hoverRect)this.onDrop.dispatch(this.hoverRect.el);this.hoverRect=null;this.started=false;}},setBounderies:function(x,y,w,h){return this.boundery=new Rect(x,y,w,h);},setDropPoints:function(e){var i,r;if(!e)return;for(i=0,e=e.split(','),this.dropRects=[];i<e.length;i++){r=DOM.getRect(e[i]);r.el=e[i];this.dropRects.push(r);}},onMouseMove:function(e){var x,y,sr=this.startRect,sp=this.startPos,b=this.boundery,dx,dy;dx=e.screenX-sp.x;dy=e.screenY-sp.y;x=sr.x+dx;y=sr.y+dy;if(b){if(x<b.x)x=b.x;if(y<b.y)y=b.y;if(x+this.w>b.x+b.w)x=(b.x+b.w)-this.w;if(y+this.h>b.y+b.h)y=(b.y+b.h)-this.h;}if(this.onDrag.dispatch(dx,dy,x,y)!==false)this.moveTo(x,y);this.handleHoverRect(dx,dy);return Event.cancel(e);},handleHoverRect:function(dx,dy){var mx,my,i,l,dr=this.dropRects;if(dr){mx=this.mouseDownPos.x+dx;my=this.mouseDownPos.y+dy;for(i=0,l=dr.length;i<l;i++){if(dr[i].containsXY(mx,my)){if(this.hoverRect!=dr[i]){if(this.hoverRect)this.onLeave.dispatch(this.hoverRect.el);this.onEnter.dispatch(dr[i].el);this.hoverRect=dr[i];}this.onOver.dispatch(dr[i].el);return;}}if(this.hoverRect){this.onLeave.dispatch(this.hoverRect.el);this.hoverRect=null;}}},startDrag:function(e){var mx,my;mx=!e.pageX?e.x+document.body.scrollLeft:e.pageX;my=!e.pageY?e.y+document.body.scrollTop:e.pageY;this.start(e.target);this.startPos=new Point(e.screenX,e.screenY);this.mouseDownPos=new Point(mx,my);},onMouseDownDrag:function(e){this.onMouseDown.dispatch(e);this.startDrag(e,'move');return Event.cancel(e);},addEventDoc:function(d){this.eventDocs.push(d);},addDocEvent:function(n,f,s){var i,dl=this.eventDocs;for(i=0;i<dl.length;i++)Event.add(dl[i],n,f,s);},removeDocEvent:function(n,f,s){var i,dl=this.eventDocs;for(i=0;i<dl.length;i++)Event.remove(dl[i],n,f,s);}});});mox.require([ 'mox.DOM','mox.List'],function(){var DOM=mox.DOM;var List=mox.List;function isset(o){return typeof(o)!='undefined';};mox.create('mox.tpl.Template',{targetId:null,templateId:null,templates:null,encoders:null,settings:null,Template:function(t,tpl,s){var e,n;this.targetId=t;this.templateId=tpl;this.templates={};this.settings={prepend_str:'',append_str:''};for(n in s)this.settings[n]=s[n];e=this.encoders={};e.urlencode=e.escape=escape;e.encodeURIComponent=encodeURIComponent;this.addEncoder('translate',function(v,r){return mox.lang.LangPack.translate(v);});},addEncoder:function(n,f){return this.encoders[n]=f;},process:function(d){var h='',tl=this.templates;this.setup();h+=this.replace(tl.header,d);h+=this.replace(tl.item,d);h+=this.replace(tl.footer,d);this._setHTML(DOM.get(this.targetId),h);},processArray:function(d){var h='',t=this,tl=t.templates;t.setup();List.map(d,function(i,v){h+=t.replace(tl.header,v);});List.map(d,function(i,v){h+=t.replace(tl.item,v);});List.map(d,function(i,v){h+=t.replace(tl.footer,v);});t._setHTML(DOM.get(t.targetId),h);},processNameValue:function(d){var h='',tl=this.templates;this.setup();h+=this.replace(tl.header,d);h+=this.replaceNameValue(tl.item,d);h+=this.replace(tl.footer,d);this._setHTML(DOM.get(this.targetId),h);},processTable:function(d){var h='',tl=this.templates;this.setup();h+=this.replace(tl.header,d.result.header);h+=this.replaceTable(tl.item,d.result.columns,d.result.data);h+=this.replace(tl.footer,d,d.result.header);this._setHTML(DOM.get(this.targetId),h);},processResultSet:function(d){var h='',tl=this.templates;this.setup();h+=this.replace(tl.header,d.header);h+=this.replaceTable(tl.item,d.columns,d.data);h+=this.replace(tl.footer,d,d.header);this._setHTML(DOM.get(this.targetId),h);},replaceNameValue:function(t,d){var n,h='';if(!t)return '';for(n in d){if(typeof(d[n])=='string')h+=this.replace(t,{name:n,value:d[n]});}return h;},replaceTable:function(t,c,d){var i,te,h='',o;if(!t)return '';for(i=0;i<d.length;i++)h+=this.replace(t,this.makeRow(c,d[i],i,d.length));return h;},makeRow:function(c,d,idx,len){var o={},i;o.$index=idx;o.$length=len;for(i=0;i<c.length;i++)o[c[i]]=d[i];return o;},replace:function(t,d){var te=this,e=te.encoders;if(!t)return '';t=t.replace(/\{\$([^\}]+)\}/g,function(a,b){var l=b.split('|'),i,v=l[0].indexOf('.')!=-1?eval('d.'+l[0]):d[l[0]];if(l.length==1)v=te.xmlEncode(v);for(i=1;i<l.length;i++)v=e[l[i]](v,d);return v;});t=t.replace(/\{\=([^\}]+)\}/g,function(a,b){return eval(b);});return t;},xmlEncode:function(s){return s?(''+s).replace(new RegExp('[<>&"\']', 'g'),function(c,b){switch(c){case '&':return '&amp;';case '"':return '&quot;';case '\'':return '&#39;';case '<':return '&lt;';case '>':return '&gt;';}return c;}):s;},getTemplateStr:function(id){var tpe,h;tpe=DOM.get(id);h=tpe.innerHTML;h=h.replace(/(<!\[CDATA\[|\]\]>)/gi,'');return h;},setup:function(){var s=this.settings,tl=this.templates;if(!tl.header&&s.header_tpl)tl.header=this.getTemplateStr(s.header_tpl);if(!tl.item)tl.item=this.getTemplateStr(this.templateId);if(!tl.footer&&s.footer_tpl)tl.footer=this.getTemplateStr(s.footer_tpl);},_setHTML:function(e,h){var n=e.nodeName,s=this.settings,m,te,nl,i;h=s.prepend_str+h+s.append_str;h=h.replace(/(width|height)=\"\s*\"/gi,'');if(!mox.isGecko&&h.match(/^\s*<tr/i)){for(nl=e.childNodes,i=nl.length-1;i>=0;i--)nl[i].parentNode.removeChild(nl[i]);te=document.createElement('div');te.innerHTML='<table>'+h+'</table>';DOM.selectElements(te,'tr',function(n){e.appendChild(n.cloneNode(true));return false;});te=null;return;}if(!mox.isGecko&& /(TABLE|SELECT)/.test(n))e.outerHTML=e.outerHTML.replace(new RegExp('<'+n+'([^<]+)>.*','i'),'<'+n+'$1>'+h+'</'+n+'>');else{if(mox.isIE&&!h&& /(TBODY)/.test(n)){n=e.firstChild;if(n){do{e.removeChild(n);}while((n=n.nextSibling)!=null);}}else e.innerHTML=h;}}});});mox.require([ 'mox.DOM','mox.lang.LangPack','mox.tpl.Template'],function(){var DOM=mox.DOM;var LangPack=mox.lang.LangPack;mox.create('mox.tpl.Paging:mox.tpl.Template',{settings:null,Paging:function(s){this.settings=s;},render:function(p,np,t){var h='',s=this.settings,i,d;d={page:p,vpage:p+1,pages:np,vpages:np+1,next:p+1,vnext:p+2,prev:p-1,vprev:p-2};if(p==0)h+=s.prev_inactive;else h+=s.prev;for(i=0;i<np;i++){d.page=i;d.vpage=i+1;if(i==p){h+=this.replace(s.page_inactive,d);}else h+=this.replace(s.page,d);}if(p==np-1)h+=s.next_inactive;else h+=s.next;h=this.replace(h,d);h=LangPack.translate(h);DOM.get(t).innerHTML=h;}});});mox.require([ 'mox.List'],function(){var List=mox.List;function isset(o){return typeof(o)!='undefined';};mox.create('mox.data.ResultSet',{columns:null,data:null,header:null,ResultSet:function(result){this.header=result.header;this.columns=result.columns;this.data=result.data;},each:function(f,i){var i;for(i=0;i<this.data.length;i++){if(f(this.getRow(i),i)===false)break;}},getColumns:function(){return this.columns;},getHeader:function(){return this.header;},getRow:function(idx){var d,c=this.columns,o={},i;if(idx<0)return null;for(i=0,d=this.data[idx];i<c.length;i++)o[c[i]]=d[i];return o;},getColByName:function(r,n){var sc,c=this.columns;for(i=0,sc=-1;i<c.length;i++){if(n==c[i]){sc=i;break;}}return sc!=-1?r[sc]:null;},getRowCount:function(){return this.data.length;},orderBy:function(by,num,desc){var t=this,c=t.columns,i,sc;desc=isset(desc)&&desc;for(i=0,sc=-1;i<c.length;i++){if(by==c[i]){sc=i;break;}}function numSort(a,b){a=parseFloat(a[sc]);b=parseFloat(b[sc]);a=isNaN(a)?0:a;b=isNaN(b)?0:b;return a-b;};function strSort(a,b){try{a=''+a[sc].toLowerCase();b=''+b[sc].toLowerCase();if(a==b)return 0;if(a<b)return-1;}catch(ex){}return 1;};if(sc!=-1)t.data=t.data.sort(num?numSort:strSort);if(desc)t.data=t.data.reverse();},toString:function(){var i,d=this.data,o='';for(i=0;i<d.length;i++)o+=d[i].join(',')+'\n';return o;}});});mox.require([ 'mox.net.JSON'],function(){var JSON=mox.net.JSON;mox.create('static mox.net.Cookie',{setJSON:function(name,value,expires,path,domain,secure){this.set(name,JSON.serialize(value),expires,path,domain,secure);},getJSON:function(name){return JSON.unserialize(this.get(name));},set:function(name,value,expires,path,domain,secure){var date=new Date();date.setTime(date.getTime()-1000);this._set(name,value,date,path,domain,secure);this._set(name,value,expires,path,domain,secure);},get:function(name){var dc=document.cookie;var prefix=name+"=";var begin=dc.indexOf("; "+prefix);if(begin==-1){begin=dc.indexOf(prefix);if(begin!=0)return null;}else begin+=2;var end=document.cookie.indexOf(";",begin);if(end==-1)end=dc.length;return unescape(dc.substring(begin+prefix.length,end));},_set:function(name,value,expires,path,domain,secure){document.cookie=name+"="+escape(value)+((expires)?"; expires="+expires.toGMTString():"")+((path)?"; path="+escape(path):"")+((domain)?"; domain="+domain:"")+((secure)?"; secure":"");}});});mox.require([ 'mox.Event','mox.DOM','mox.List','mox.String','mox.dom.Layer','mox.lang.LangPack','mox.geom.Rect','mox.util.Dispatcher'],function(){var Event=mox.Event;var DOM=mox.DOM;var List=mox.List;var String=mox.String;var Layer=mox.dom.Layer;var LangPack=mox.lang.LangPack;var Dispatcher=mox.util.Dispatcher;mox.create('static mox.ui.WindowManager',{windows:[],lastWin:null,alertWin:null,progressTheme:null,zindex:0,settings:null,onopen:null,onclose:null,init:function(s){var n;this.settings={};for(n in s)this.settings[n]=s[n];},open:function(u,id,f,args){var w=this.get(id);if(w)w.close();this.lastWin=w=new mox.ui.Window(id,this._splitNameValue(f));if(this.onbeforeopen)this.onbeforeopen(w);w.setArgs(args);w.open();w.setURL(u);this.remove(w);this.windows.push(w);if(this.onopen)this.onopen(w);return w;},error:function(msg,ti,f,cb){this.alert('error',ti,msg,f,cb);},warn:function(msg,ti,f,cb){this.alert('warning',ti,msg,f,cb);},info:function(msg,ti,f,cb){this.alert('info',ti,msg,f,cb);},alert:function(l,ti,msg,f,cb){var id='alert';this.hideProgress();f=this._splitNameValue(f);f=!f?{}:f;f.blockevents=true;f.type='alert';f.bigicon=l;f.onclose=cb;f.width=400;f.height=130;f.resizable=false;w=this.open(null,id,f);w.setTitle(ti);w.setContent('<div class="message">'+msg+'</div><a href="javascript:mox.ui.WindowManager.get(\'' + id + '\').close();" class="action ok">{#common.alert_ok}</a>');},confirm:function(msg,yes_cb,ti,f,no_cb){var id='confirm';this.hideProgress();f=this._splitNameValue(f);f=!f?{}:f;f.blockevents=true;f.type='confirm';f.bigicon='ask';f.width=400;f.height=130;f.resizable=false;w=this.open(null,id,f);w.onconfirm=yes_cb;w.oncancel=no_cb;w.setTitle(ti);w.setContent('<div class="message">'+msg+'</div><a href="javascript:mox.ui.WindowManager.get(\'' + id + '\').ok();" class="action ok">{#common.confirm_yes}</a><a href="javascript:mox.ui.WindowManager.get(\'' + id + '\').close();" class="action cancel">{#common.confirm_no}</a>');},status:function(msg,status,type,ti,f,cb){var id='status';if(!msg||!status)return true;this.hideProgress();f=this._splitNameValue(f);type=!type?'error':type;f=!f?{}:f;f.blockevents=true;f.type='status';f.bigicon=type;f.onclose=cb;f.width=400;f.height=300;f.resizable=false;w=this.open(null,id,f);w.setTitle(ti);w.setContent('<div class="message">'+msg+'</div><div class="statustext">'+status+'</div><a id="'+id+'_ok_btn" href="javascript:mox.ui.WindowManager.get(\'' + id + '\').close();" class="action ok">{#common.alert_ok}</a>');return false;},showProgress:function(msg,theme){var id,vp=DOM.getViewPort();theme=!theme?'clearlooks2':theme;id=theme+'_progress';if(!DOM.get(theme+'_event_blocker'))document.body.appendChild(DOM.createTag('div',{id:theme+'_event_blocker','class':theme+'_event_blocker'}));DOM.addClass(theme+'_event_blocker',theme+'_visible_event_blocker');DOM.show(theme+'_event_blocker');if(!DOM.get(id)){DOM.addTags(document.body,['div',{id:id,'class':theme+'_progress'},['div',{id:id+'_msg','class':'message'}] ]);}DOM.get(id+'_msg').innerHTML=msg;DOM.show(id);DOM.setStyles(id,{left:(vp.w / 2) - (DOM.get(id).clientWidth / 2)+'px',top:(vp.h / 2) - (DOM.get(id).clientHeight / 2)+'px'});this.progressTheme=theme;},hideProgress:function(){var th=this.progressTheme;DOM.hide(th+'_event_blocker');DOM.hide(th+'_progress');},getWindows:function(){return this.windows;},get:function(n){var w=null;List.map(this.windows,function(i,v){if(v.name==n)w=v;});return w;},getLastWindow:function(){return this.lastWin;},closeAll:function(){List.map(this.windows,function(i,v){v.close();});},blurAll:function(){List.map(this.windows,function(i,v){v.blur();});},remove:function(w){this.windows=List.filter(this.windows,function(i,v){return w.name!=v.name;});},moveToFront:function(w){this.remove(w);this.windows.push(w);},_splitNameValue:function(s,f){var o={},i,c;if(typeof(s)!='string')return s;s=s.split(',');for(i=0;i<s.length;i++){c=s[i].split('=');if(c.length<2)f&&(o[f(c[0])]=c[0]);else o[c[0]]=c[1];}return o;}});mox.create('mox.ui.Window:mox.dom.Drag',{name:null,url:null,features:null,args:null,borders:null,dragAction:null,placeHolder:null,zIndexes:null,buttons:null,Window:function(name,f){var id='mcwindow_'+name,t=this,vp=DOM.getViewPort(),n,co,en='div';this.features={top:'center',left:'center',width:320,height:240,type:'window',resizable:false,theme:'clearlooks2'};for(n in f)this.features[n]=f[n];f=this.features;this.buttons=['close','min','max','move','resize_n','resize_nw','resize_ne','resize_w','resize_e','resize_s','resize_sw','resize_se'];if(f.type=='window')mc=['iframe',{id:id+'_content',src:'about:blank','class':'middle',frameBorder:'0'}];else mc=['div',{id:id+'_content','class':'middle'},' '];DOM.addTags(document.body,['div',{id:id,'class':f.theme+' window'},['div',{id:id+'_container','class':'statusbar'},['div',{id:id+'_top','class':'windowtop'},['div',{'class':'left'}],['div',{'class':'middle'}],['div',{'class':'right'}],['div',{id:id+'_title','class':'title'},' '],['a',{id:id+'_min',href:'javascript:mox.ui.WindowManager.get(\'' + name + '\').minimize();','class':'action min'}],['a',{id:id+'_max',href:'javascript:mox.ui.WindowManager.get(\'' + name + '\').maximize();','class':'action max'}],['a',{id:id+'_close',href:'javascript:mox.ui.WindowManager.get(\'' + name + '\').close();','class':'action close'}],[en,{id:id+'_move','class':'action move',tabindex:'-1'}],[en,{id:id+'_resize_n','class':'action resize resize-n',tabindex:'-1'}],[en,{id:id+'_resize_nw','class':'action resize resize-nw',tabindex:'-1'}],[en,{id:id+'_resize_ne','class':'action resize resize-ne',tabindex:'-1'}] ],['div',{id:id+'_middle','class':'windowmiddle'},['div',{'class':'left'}],mc,['div',{'class':'right'}],['div',{id:id+'_bigicon','class':'bigicon'}],[en,{id:id+'_resize_w','class':'action resize resize-w',tabindex:'-1'}],[en,{id:id+'_resize_e','class':'action resize resize-e',tabindex:'-1'}] ],['div',{id:id+'_bottom','class':'windowbottom'},['div',{'class':'left'}],['div',{'class':'middle'}],['div',{'class':'right'}],['div',{id:id+'_statustext','class':'statustext'},' '],[en,{id:id+'_resize_s','class':'action resize resize-s',tabindex:'-1'}],[en,{id:id+'_resize_sw','class':'action resize resize-sw',tabindex:'-1'}],[en,{id:id+'_resize_se','class':'action resize resize-se',tabindex:'-1'}] ] ] ]);co=DOM.get('mcwindow_container');if(!co)co=document.body.appendChild(DOM.createTag('div',{id:'mcwindow_container',style:'position: absolute; left: 0; top: 0; z-index: 100000; display: none;'}));co.appendChild(DOM.createTag('div',{id:id+'_placeholder','class':f.theme+'_placeholder'}));this.placeHolder=new Layer(id+'_placeholder');this.parent(id,{drag_handle:id+'_'+['move','resize_n','resize_nw','resize_ne','resize_w','resize_e','resize_s','resize_sw','resize_se'].join(','+id+'_')});this.onDragStart.add(this.dragStartEvent);this.onDragEnd.add(this.dragEndEvent);this.onDrag.add(this.dragEvent);this.name=name;DOM.addClass(id+'_container',f.type);if(f.bigicon)DOM.addClass(id+'_bigicon',f.bigicon);if(f.chromeless)DOM.addClass(id+'_container','chromeless');if(f.resizable)DOM.addClass(id+'_container','resizable');if(f.statusbar){DOM.addClass(id+'_container','statusbar');DOM.addClass(id+'_bottom','statusbarbottom');}this.setBounderies(0,0,vp.w-2,vp.h-2);this.onClose=new Dispatcher(this);},setTitle:function(h){if(h){h=(''+h).replace(/^(http|https):\/\/[a-z0-9._\-\s]+-/gi,'');DOM.get(this.id+'_title').innerHTML=h;}},setContent:function(h){if(h)DOM.get(this.id+'_content').innerHTML=LangPack.translate(h);},setStatus:function(t){if(t)DOM.get(this.id+'_statustext').innerHTML=t;},getDocumentRect:function(){var w,h,d=document;w=h=0;if(d.scrollWidth>w)w=d.scrollWidth;if(d.scrollHeight>h)h=d.scrollHeight;if(d.documentElement.scrollWidth>w)w=d.documentElement.scrollWidth;if(d.documentElement.scrollHeight>h)h=d.documentElement.scrollHeight;if(d.body.scrollWidth>w)w=d.body.scrollWidth;if(d.body.scrollHeight>h)h=d.body.scrollHeight;return new mox.geom.Rect(0,0,w,h);},focus:function(){var id=this.id,f=this.features,r=this.getDocumentRect();if(!DOM.get(f.theme+'_event_blocker'))document.body.appendChild(DOM.createTag('div',{id:f.theme+'_event_blocker','class':f.theme+'_event_blocker'}));mox.ui.WindowManager.blurAll();mox.ui.WindowManager.zindex++;if(f.blockevents){if(mox.isIE){DOM.selectElements(document,'select',function(n){n.oldDisabled=n.disabled;n.disabled=true;});}this.setZIndex(100010);DOM.setStyles(f.theme+'_event_blocker',{width:r.w+'px',height:r.h+'px'});DOM.show(f.theme+'_event_blocker');DOM.addClass(f.theme+'_event_blocker',f.theme+'_visible_event_blocker');}else{this.setZIndex(mox.ui.WindowManager.zindex);DOM.removeClass(f.theme+'_event_blocker',f.theme+'_visible_event_blocker');}DOM.addClass(id+'_container','focus');DOM.addClass(id+'_top','focustop');DOM.addClass(id+'_middle','focusmiddle');DOM.addClass(id+'_bottom','focusbottom');mox.ui.WindowManager.moveToFront(this);},blur:function(){DOM.removeClass(this.id+'_container','focus');DOM.removeClass(this.id+'_top','focustop');DOM.removeClass(this.id+'_middle','focusmiddle');DOM.removeClass(this.id+'_bottom','focusbottom');},setZIndex:function(z){var t=this;DOM.setStyle(t.id,'z-index',z);List.map(this.buttons,function(i,v){DOM.setStyle(t.id+'_'+v,'z-index',z+t.zIndexes[v]);});},setStatusbar:function(s){if(s){DOM.addClass(this.id+'_container','statusbar');DOM.addClass(this.id+'_top','statusbartop');DOM.addClass(this.id+'_middle','statusbartop');DOM.addClass(this.id+'_bottom','statusbartop');}else{DOM.removeClass(this.id+'_container','statusbar');DOM.removeClass(this.id+'_top','statusbartop');DOM.removeClass(this.id+'_middle','statusbarmiddle');DOM.removeClass(this.id+'_bottom','statusbarbottom');}},minimize:function(){this.setStatusbar(false);this.resizeTo(this.w,28);},maximize:function(){var vp=DOM.getViewPort();this.moveTo(vp.x,vp.y);this.resizeTo(vp.w,vp.h);},setupBlockMode:function(){var ua;ua=navigator.userAgent;this.setBlockMode(ua.indexOf('MSIE 5')>0||ua.indexOf('MSIE 6')>0);this.update();},dragStartEvent:function(el){var f=this.features;this.focus();this.dragAction=DOM.getAttrib(el,'class').replace(/(action\s+|resize\s+)/g,'');this.placeHolder.moveTo(this.x,this.y);this.placeHolder.resizeTo(this.w,this.h);this.placeHolder.show();this.hide();this.update();DOM.show(f.theme+'_event_blocker');DOM.show('mcwindow_container');},dragEndEvent:function(){var p=this.placeHolder,f=this.features;this.moveTo(p.x,p.y);this.resizeTo(p.w,p.h);this.show();this.placeHolder.hide();if(!f.blockevents)DOM.hide(f.theme+'_event_blocker');DOM.hide('mcwindow_container');this.setupBlockMode();},dragEvent:function(dx,dy,x,y){var sr=this.startRect,l=this.placeHolder;switch(this.dragAction){case 'resize-n':l.moveTo(sr.x,y);l.resizeTo(sr.w,sr.h-dy);break;case 'resize-nw':l.moveTo(x,y);l.resizeTo(sr.w-dx,sr.h-dy);break;case 'resize-ne':l.moveTo(sr.x,y);l.resizeTo(sr.w+dx,sr.h-dy);break;case 'resize-w':l.moveTo(x,sr.y);l.resizeTo(sr.w-dx,sr.h);break;case 'resize-e':l.resizeTo(sr.w+dx,sr.h);break;case 'resize-s':l.resizeTo(sr.w,sr.h+dy);break;case 'resize-sw':l.moveTo(sr.x+dx,sr.y);l.resizeTo(sr.w-dx,sr.h+dy);break;case 'resize-se':l.resizeTo(sr.w+dx,sr.h+dy);break;case 'move':l.moveTo(x,y);break;}},setURL:function(u){this.url=u;if(u){if(DOM.get(this.id+'_content').contentDocument)DOM.get(this.id+'_content').contentDocument.location=u;else DOM.get(this.id+'_content').contentWindow.document.location=u;}},getInnerWin:function(){return DOM.get(this.id+'_content').contentWindow;},setFeatures:function(f){var n;for(n in f)this.features[n]=f[n];},setArgs:function(a){this.args=a;},getArgs:function(){return this.args;},ok:function(){if(this.onconfirm)this.onconfirm(this);this.close();},open:function(){this.moveTo(-1000,-1000);this.show();if(mox.isOpera)window.setTimeout(mox.bind(this,this.setupWindow),1000);else this.setupWindow();},setupWindow:function(){var w,h,t=this,f=this.features,id=this.id,iw,ih,vp=DOM.getViewPort(),wm=mox.ui.WindowManager;t.zIndexes=[];List.map(this.buttons,function(i,v){var s=DOM.getStyle(t.id+'_'+v,'z-index');t.zIndexes[v]=s||0;});iw=ih=0;iw+=parseInt(DOM.getStyle(DOM.getByClass(id+'_middle','div','left')[0],'width'));iw+=parseInt(DOM.getStyle(DOM.getByClass(id+'_middle','div','right')[0],'width'));ih+=parseInt(DOM.getStyle(id+'_top','height'));ih+=parseInt(DOM.getStyle(id+'_bottom','height'));this.borders={w:iw,h:ih-1};w=f.width;h=f.height;if(f.fullscreen=='yes'){f.left=f.top=0;w=vp.w;h=vp.h;Event.add(window,'resize',this.onresize,this);}if(w=='max')w=vp.w;if(h=='max')h=vp.h;if(f.left=='center')f.left=vp.x+(vp.w / 2) - parseInt(f.width / 2);if(f.top=='center')f.top=vp.y+(vp.h / 2) - parseInt(f.height / 2);this.setupBlockMode();this.moveTo(parseInt(f.left),parseInt(f.top));this.resizeTo(w,h);this.focus();this.update();},close:function(){var wm=mox.ui.WindowManager,wl,f=this.features;if(this.onClose.dispatch()===false)return;Event.remove(window,'resize',this.onresize,this);DOM.remove(this.id);DOM.remove(this.id+"_blocker");wm.remove(this);wl=wm.windows;if(wl.length>0)wl[wl.length-1].focus();if(f.blockevents){if(mox.isIE){DOM.selectElements(document,'select',function(n){n.disabled=n.oldDisabled;});}}DOM.hide(f.theme+'_event_blocker');if(f.onclose)f.onclose(this);if(wm.onclose)wm.onclose(this);},resizeTo:function(x,y){var b=this.borders;x=parseInt(x);y=parseInt(y);this.parent(x,y);DOM.setStyle(this.id,'visibility','hidden');DOM.setStyles(this.id+'_content',{width:(x-b.w)+'px',height:(y-b.h)+'px'});DOM.setStyle(this.id,'visibility','visible');},resizeBy:function(x,y){var b=this.borders;this.parent(parseInt(x),parseInt(y));DOM.setStyle(this.id,'visibility','hidden');DOM.setStyles(this.id+'_content',{width:(this.w-b.w)+'px',height:(this.h-b.h)+'px'});DOM.setStyle(this.id,'visibility','visible');},onresize:function(e){var vp=DOM.getViewPort();this.resizeTo(vp.w,vp.h);}});});mox.require([ 'mox.List'],function(){var List=mox.List;mox.create('mox.ui.Menu:mox.ui.MenuItem',{Menu:function(id,s){this.parent();this._id=id;this._settings={};},addList:function(id){},addArray:function(a,te){var i,n;if(!te)te=this;if(te.length){te=te.appendItem(this.createItem(a[0],a[1],a[2]));for(i=2;i<a.length;i++)this.addArray(te,a[i]);}},createItem:function(t,u,i){return new mox.ui.MenuItem(t,u,i);},render:function(){}});});mox.require([ 'mox.List'],function(){mox.create('mox.ui.MenuItem',{MenuItem:function(t,u,e){this._text=t;this._url=u;this._extra=e;this._items=[];this._collapsed=false;},getText:function(){return this._text;},setText:function(v){this._text=v;},getURL:function(){return this._url;},setURL:function(v){this._url=v;},getExtra:function(){return this._extra;},setExtra:function(v){this._extra=v;},expand:function(d){},collapse:function(d){},isCollapsed:function(){return this._collapsed;},getItems:function(){return this._items;},appendItem:function(n){this._items.push(n);return n;},insertBefore:function(n,r){},removeItem:function(n){var i=List.indexOf(this._items,n);if(i!=-1)this._items.splice(i,1);}});});mox.require([ 'mox.List','mox.DOM','mox.util.Dispatcher'],function(){var DOM=mox.DOM;var List=mox.List;var Dispatcher=mox.util.Dispatcher;mox.create('mox.ui.DropMenu:mox.ui.DropMenuItem',{DropMenu:function(s){this.parent();this._settings=s;},createItem:function(t,u,e){return new mox.ui.DropMenuItem(t,u,e);},render:function(){var t=this,c,s=this._settings;c='Menu';if(mox.isIE)c+=' isIE';if(s&&s['class'])c+=s['class'];document.body.appendChild(DOM.createTag('ul',{id:t.setID(DOM.uniqueId()),'class':c}));List.each(t.getItems(),function(i,n){var e=n.getExtra(),li,id;c='MenuItem';if(n.isFirst())c+=' MenuItemFirst';if(e&&e['class'])c+=' '+e['class'];id=n.getID()?n.getID():n.setID(DOM.uniqueId());li=DOM.createTag('li',{id:id,'class':c});li.appendChild(DOM.createTag('a',{href:n.getURL()},n.getText()));DOM.get(t._id).appendChild(li);});}});});mox.require([ 'mox.List','mox.DOM','mox.util.Dispatcher'],function(){var DOM=mox.DOM;var List=mox.List;var Dispatcher=mox.util.Dispatcher;mox.create('mox.ui.DropMenuItem:mox.ui.MenuItem',{DropMenuItem:function(t,u,e){this.parent(t,u,e);if(e){this._id=e.id?e.id:null;}this.onShow=new Dispatcher();this.onHide=new Dispatcher();},getID:function(){return this._id;},setID:function(v){return this._id=v;},appendItem:function(n){n._parent=this;this.parent(n);return n;},addClass:function(c){DOM.addClass(this._id,c);},removeClass:function(c){DOM.removeClass(this._id,c);},hasClass:function(c){return!DOM.hasClass(this._id,c);},show:function(x,y){if(this.onShow.dispatch()!==false){if(typeof(x)!='undefined')this.moveTo(x,y);DOM.show(this._id);}},moveTo:function(x,y){DOM.setStyles(this._id,{left:x+'px',top:y+'px'});},hide:function(){if(this.onHide.dispatch()!==false)DOM.hide(this._id);},isFirst:function(){return this._parent.getItems()[0]==this;},expand:function(d){this.removeClass('MenuHidden');},collapse:function(d){this.addClass('MenuHidden');},getRect:function(){var o,r,b;o=DOM.getStyle(this._id,'opacity');b=DOM.getStyle(this._id,'display');DOM.setStyle(this._id,'opacity',0);DOM.show(this._id);r=DOM.getRect(this._id,true);DOM.setStyle(this._id,'opacity',o);if(b)DOM.setStyle(this._id,'display',b);return r;}});});mox.require([ 'mox.DOM','mox.geom.Rect'],function(){var DOM=mox.DOM;var Rect=mox.geom.Rect;mox.create('mox.dom.Layer:mox.geom.Rect',{Layer:function(id,bm){this.parent(null,null,null,null);this.id=id;this.events=false;this.element=null;this.blockMode=typeof(bm)!='undefined'?bm:false;this.lastRect=new Rect(null,null,null,null);},moveRelativeTo:function(re,p,rp){var x,y,r=DOM.getRect(re);this.updateRect();this.moveTo(0,0);p=this.getLocation(p);rp=r.getLocation(rp);x=rp.x-p.x;y=rp.y-p.y;this.moveTo(x,y);},moveBy:function(x,y){this.updateRect();this.parent(x,y);this.update();},moveTo:function(x,y){this.parent(x,y);this.update();},resizeBy:function(w,h){this.updateRect();this.parent(w,h);this.update();},resizeTo:function(w,h){this.parent(w,h);this.update();},setStyle:function(n,v){DOM.setStyle(this.getElement(),n,v);},getStyle:function(n){return DOM.getStyle(this.getElement(),n);},show:function(){DOM.show(this.getElement());},hide:function(){DOM.hide(this.getElement());},isHidden:function(){return this.getStyle('display')=='none';},setVisible:function(s){this.setStyle('visibility',s?'visible':'hidden');return s;},isVisible:function(){return this.getStyle('visibility')=='visible';},getElement:function(){return document.getElementById(this.id);},getEl:function(){return this.getElement();},setBlockMode:function(s,u){b=this.getBlocker();this.blockMode=s;if(u){b.style.left=this.x+'px';b.style.top=this.y+'px';b.style.width=this.w+'px';b.style.height=this.h+'px';}},updateRect:function(f){if(this.x==null||f)DOM.getRect(this.getElement(),true,this);},update:function(){var e=this.getElement(),b;if(this.x!=this.lastRect.x)e.style.left=this.x+'px';if(this.y!=this.lastRect.y)e.style.top=this.y+'px';if(this.w>=0&&this.w!=this.lastRect.w&&this.w!=null)e.style.width=this.w+'px';if(this.h>=0&&this.h!=this.lastRect.h&&this.h!=null)e.style.height=this.h+'px';if(this.blockMode){b=this.getBlocker();if(this.x!=this.lastRect.x)b.style.left=this.x+'px';if(this.y!=this.lastRect.y)b.style.top=this.y+'px';if(this.w!=this.lastRect.w&&this.w!=null)b.style.width=this.w+'px';if(this.h!=this.lastRect.h&&this.h!=null)b.style.height=this.h+'px';b.style.zIndex=(parseInt(this.getEl().style.zIndex)-1);b.style.display=e.style.display;}this.lastRect.set(this.x,this.y,this.w,this.h);},getBlocker:function(){var d,b;if(this.blockMode){d=document;b=d.getElementById(this.id+"_blocker");if(!b){b=d.createElement("iframe");b.setAttribute('id',this.id+"_blocker");b.style.cssText='display: none; position: absolute; left: 0; top: 0;';b.src='about:blank';b.frameBorder='0';b.scrolling='no';d.body.appendChild(b);}return b;}return null;},exists:function(){return document.getElementById(this.id)!=null;},parseInt:function(s){if(s==null||s=='')return 0;return parseInt(s);},remove:function(){var e=this.getElement(),b=this.getBlocker();if(e)e.parentNode.removeChild(e);if(b)b.parentNode.removeChild(b);}});});mox.require([ 'mox.DOM','mox.util.Dispatcher'],function(){var DOM=mox.DOM;var Dispatcher=mox.util.Dispatcher;mox.create('mox.dom.Tween',{timer:null,settings:null,items:null,target:null,noNeg: /opacity|width|height|padding|border\-width/i,Tween:function(t,a,s){var n,o,tr;this.target=t;this.settings={fps:100,frames:100,transition:this.linear.easeNone,time:0};tr=s.transition;if(typeof(tr)=='string'){tr=tr.split('.');s.transition=this[tr[0]][tr[1]];s.transitionScope=this[tr[0]];}for(n in s)this.settings[n]=s[n];s=this.settings;if(s.time>0)s.frames=Math.round(s.time/1000.0 * s.fps);for(n in a){o=a[n];if(typeof(o.from)=='undefined')o.from=parseInt(DOM.getStyle(t,n));if(typeof(o.to)=='undefined')o.to=parseInt(DOM.getStyle(t,n));}this.items=a;this.onStart=new Dispatcher();this.onEnd=new Dispatcher();},onStart:null,onEnd:null,start:function(e){var t=this,s=t.settings,st,fc=0,fs=1;if(this.timer)return false;st=new Date().getTime();if(this.onStart.dispatch()===false)return;this.update(0);this.timer=window.setInterval(function(){var f=(new Date().getTime()-st)/1000.0 * s.fps;if(f>fc)fs=f-fc;if((fc+=fs)>s.frames){fc=s.frames;t.update(fc);t.stop();return;}t.update(fc);},1000/this.settings.fps);return true;},stop:function(e){if(this.timer){window.clearInterval(this.timer);this.timer=null;this.onEnd.dispatch();}},update:function(fc){var n,v,il=this.items,it,s=this.settings;for(n in il){it=il[n];it.value=s.transition.call(s.transitionScope,fc,it.from,it.to-it.from,this.settings.frames);if(n=='opacity')v=it.value/100.0;else v=Math.round(it.value)+(it.unit?it.unit:'px');if(v<0&&this.noNeg.test(n))v=Math.abs(v);DOM.setStyle(this.target,n,v);}},back:{easeIn:function(t,b,c,d,s){if(s==undefined)s=1.70158;return c*(t/=d)*t*((s+1)*t-s)+b;},easeOut:function(t,b,c,d,s){if(s==undefined)s=1.70158;return c*((t=t/d-1)*t*((s+1)*t+s)+1)+b;},easeInOut:function(t,b,c,d,s){if(s==undefined)s=1.70158;if((t/=d/2)<1)return c/2*(t*t*(((s*=(1.525))+1)*t-s))+b;return c/2*((t-=2)*t*(((s*=(1.525))+1)*t+s)+2)+b;}},bounce:{easeOut:function(t,b,c,d){if((t/=d)<(1/2.75)){return c*(7.5625*t*t)+b;}else if(t<(2/2.75)){return c*(7.5625*(t-=(1.5/2.75))*t+.75)+b;}else if(t<(2.5/2.75)){return c*(7.5625*(t-=(2.25/2.75))*t+.9375)+b;}else{return c*(7.5625*(t-=(2.625/2.75))*t+.984375)+b;}},easeIn:function(t,b,c,d){return c-this.easeOut(d-t,0,c,d)+b;},easeInOut:function(t,b,c,d){if(t<d/2)return this.easeIn(t*2,0,c,d)* .5+b;else return this.easeOut(t*2-d,0,c,d)* .5+c*.5+b;}},circ:{easeIn:function(t,b,c,d){return-c *(Math.sqrt(1-(t/=d)*t)-1)+b;},easeOut:function(t,b,c,d){return c * Math.sqrt(1-(t=t/d-1)*t)+b;},easeInOut:function(t,b,c,d){if((t/=d/2)<1)return-c/2 *(Math.sqrt(1-t*t)-1)+b;return c/2 *(Math.sqrt(1-(t-=2)*t)+1)+b;}},cubic:{easeIn:function(t,b,c,d){return c*(t/=d)*t*t+b;},easeOut:function(t,b,c,d){return c*((t=t/d-1)*t*t+1)+b;},easeInOut:function(t,b,c,d){if((t/=d/2)<1)return c/2*t*t*t+b;return c/2*((t-=2)*t*t+2)+b;}},elastic:{easeIn:function(t,b,c,d,a,p){if(t==0)return b;if((t/=d)==1)return b+c;if(!p)p=d*.3;if(!a||a<Math.abs(c)){a=c;var s=p/4;}else var s=p/(2*Math.PI)* Math.asin(c/a);return-(a*Math.pow(2,10*(t-=1))* Math.sin((t*d-s)*(2*Math.PI)/p))+b;},easeOut:function(t,b,c,d,a,p){if(t==0)return b;if((t/=d)==1)return b+c;if(!p)p=d*.3;if(!a||a<Math.abs(c)){a=c;var s=p/4;}else var s=p/(2*Math.PI)* Math.asin(c/a);return(a*Math.pow(2,-10*t)* Math.sin((t*d-s)*(2*Math.PI)/p)+c+b);},easeInOut:function(t,b,c,d,a,p){if(t==0)return b;if((t/=d/2)==2)return b+c;if(!p)p=d*(.3*1.5);if(!a||a<Math.abs(c)){a=c;var s=p/4;}else var s=p/(2*Math.PI)* Math.asin(c/a);if(t<1)return-.5*(a*Math.pow(2,10*(t-=1))* Math.sin((t*d-s)*(2*Math.PI)/p))+b;return a*Math.pow(2,-10*(t-=1))* Math.sin((t*d-s)*(2*Math.PI)/p)*.5+c+b;}},expo:{easeIn:function(t,b,c,d){return(t==0)?b:c * Math.pow(2,10 *(t/d-1))+b;},easeOut:function(t,b,c,d){return(t==d)?b+c:c *(-Math.pow(2,-10 * t/d)+1)+b;},easeInOut:function(t,b,c,d){if(t==0)return b;if(t==d)return b+c;if((t/=d/2)<1)return c/2 * Math.pow(2,10 *(t-1))+b;return c/2 *(-Math.pow(2,-10 *--t)+2)+b;}},linear:{easeNone:function(t,b,c,d){return c*t/d+b;},easeIn:function(t,b,c,d){return c*t/d+b;},easeOut:function(t,b,c,d){return c*t/d+b;},easeInOut:function(t,b,c,d){return c*t/d+b;}},quad:{easeIn:function(t,b,c,d){return c*(t/=d)*t+b;},easeOut:function(t,b,c,d){return-c *(t/=d)*(t-2)+b;},easeInOut:function(t,b,c,d){if((t/=d/2)<1)return c/2*t*t+b;return-c/2 *((--t)*(t-2)-1)+b;}},quart:{easeIn:function(t,b,c,d){return c*(t/=d)*t*t*t+b;},easeOut:function(t,b,c,d){return-c *((t=t/d-1)*t*t*t-1)+b;},easeInOut:function(t,b,c,d){if((t/=d/2)<1)return c/2*t*t*t*t+b;return-c/2 *((t-=2)*t*t*t-2)+b;}},quint:{easeIn:function(t,b,c,d){return c*(t/=d)*t*t*t*t+b;},easeOut:function(t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b;},easeInOut:function(t,b,c,d){if((t/=d/2)<1)return c/2*t*t*t*t*t+b;return c/2*((t-=2)*t*t*t*t+2)+b;}},sine:{easeIn:function(t,b,c,d){return-c * Math.cos(t/d *(Math.PI/2))+c+b;},easeOut:function(t,b,c,d){return c * Math.sin(t/d *(Math.PI/2))+b;},easeInOut:function(t,b,c,d){return-c/2 *(Math.cos(Math.PI*t/d)-1)+b;}}});});mox.create('static mox.net.JSON',{synchronous:false,debug:false,encoded:false,serialize:function(o){var i,v,s=mox.net.JSON.serialize,t;if(o==null)return 'null';t=typeof o;if(t=='string'){v='\bb\tt\nn\ff\rr\""\'\'\\\\';return '"'+o.replace(new RegExp('([\u0080-\uFFFF\\x00-\\x1f\\\\"])','g'),function(a,b){i=v.indexOf(b);if(i+1)return '\\'+v.charAt(i+1);a=b.charCodeAt().toString(16);return '\\u'+'0000'.substring(a.length)+a;})+'"';}if(t=='object'){if(o instanceof Array){for(i=0,v='[';i<o.length;i++)v+=(i>0?',':'')+s(o[i]);return v+']';}v='{';for(i in o)v+=typeof o[i]!='function'?(v.length>1?',"':'"')+i+'":'+s(o[i]):'';return v+'}';}return ''+o;},unserialize:function(s){if(!mox.isSafari){if(!/^("(\\.|[^"\\\n\r])*?"|[,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t])+?$/.test(s))return 'INVALID_JSON_STRING';}try{return eval('('+s+')');}catch(ex){return 'INVALID_JSON_STRING';}},send:function(u,o,r,e,i){if(mox.net.JSON.synchronous)this.sendSync(u,o,r,e,i);else this.sendAsync(u,o,r,e,i);},sendSync:function(u,o,r,e,i){var j=this,x;function g(s){x=0;try{x=new ActiveXObject(s);}catch(s){}return x;};x=window.ActiveXObject?g('Msxml2.XMLHTTP')||g('Microsoft.XMLHTTP'):new XMLHttpRequest();if(!x)return r('ERR_NO_XMLHTTP',null,x.responseText,u,o,x);!i||i(x);x.overrideMimeType&&x.overrideMimeType('text/plain');x.open('POST',u,false);x.setRequestHeader('Content-Type','application/json');x.async=false;x.send(j.serialize(o));if(j.debug){mox.log("RPC Request [JSON]: "+j.serialize(o));mox.log("RPC Response [OBJ]: ",j.unserialize(x.responseText));mox.log("RPC Response [JSON]: "+x.responseText);}c=j.unserialize(x.responseText);if(c=='INVALID_JSON_STRING')return r('ERR_NOT_JSON',null,x.responseText,u,o,x);r('OK',c,x.responseText,u,o,x);},sendAsync:function(u,o,r,e,i){var j=this,x,p;function g(s){x=0;try{x=new ActiveXObject(s);}catch(s){}return x;};x=window.ActiveXObject?g('Msxml2.XMLHTTP')||g('Microsoft.XMLHTTP'):new XMLHttpRequest();if(!x)return cb('ERR_NO_XMLHTTP',null,x.responseText,u,o,x);!i||i(x);x.open('POST',u,true);if(!e&&!mox.net.JSON.encoded){x.overrideMimeType&&x.overrideMimeType('text/plain');x.setRequestHeader('Content-Type','application/json');p=j.serialize(o);}else{p="json_data="+escape(j.serialize(o));x.setRequestHeader("Content-type","application/x-www-form-urlencoded");x.setRequestHeader("Content-length",p.length);}this.waitForResponse(u,o,x,r,e,i);x.send(p);},waitForResponse:function(u,o,x,cb,e,i){var j=this,t,c=0;t=window.setInterval(function(){if(x.readyState==4||c++>10000){window.clearInterval(t);if(x.status==403||x.status==404||x.status==405){mox.net.JSON.encoded=1;if(!e)j.sendAsync(u,o,cb,1,i);return false;}if(x.readyState==4){if(j.debug){mox.log("RPC Request [JSON]: "+j.serialize(o));mox.log("RPC Response [OBJ]: ",j.unserialize(x.responseText));mox.log("RPC Response [RAW]: "+x.responseText);}}if(c>10000)return cb('ERR_TIMEOUT',null,x.responseText,u,o,x);c=j.unserialize(x.responseText);if(c=='INVALID_JSON_STRING')return cb('ERR_NOT_JSON',null,x.responseText,u,o,x);cb('OK',c,x.responseText,u,o,x);}},10);}});mox.require([ 'mox.DOM'],function(){var DOM=mox.DOM;mox.create('static mox.dom.Form',{selectOption:function(f,n,v){var i,ol=f.elements[n].options;for(i=0;i<ol.length;i++){if(ol[i].value==v){ol[i].selected=true;return ol[i];}}return null;},addOption:function(f,n,on,ov){var e=f.elements[n],ol=e.options;o.selected=true;return ol.push(new Option(on,ov));},getRadioValue:function(f,n){var i,nl;for(i=0,nl=f.elements[n];i<nl.length;i++){if(nl[i].checked)return nl[i].value;}return null;},getValue:function(f,n){var e=f.elements[n];switch(e.type){case 'SELECT':return e.options[e.selectedIndex].value;}return e.value;}});});mox.require([ 'mox.List'],function(){mox.create('mox.util.Dispatcher',{_listeners:null,_scope:null,Dispatcher:function(s){this._listeners=[];this._scope=s;},add:function(f,s){this._listeners.push({func:f,scope:!s?this._scope:s});},dispatch:function(){var a=arguments,s=true;mox.List.each(this._listeners,function(i,v){return s=v.func.apply(!v.scope?window:v.scope,a);});return s;}});});mox.require([ 'mox.util.Dispatcher','mox.net.JSON','mox.tpl.Template'],function(){var Dispatcher=mox.util.Dispatcher;mox.create('moxiecode.manager.BaseManager',{settings:null,json:mox.net.JSON,rpcCounter:0,args:null,callSettings:null,BaseManager:function(s){var baseDir;baseDir=document.location.href;if(baseDir.indexOf('?')!=-1)baseDir=baseDir.substring(0,baseDir.indexOf('?'));baseDir=baseDir.substring(0,baseDir.lastIndexOf('/')+1);this.settings={document_base_url:unescape(baseDir),relative_urls:false,remove_script_host:false,path:null,rootpath:null,remember_last_path:true,custom_data:null,target_elements:'',target_form:''};this.onResult=new Dispatcher(this);this.onError=new Dispatcher(this);this.init(s);},init:function(s){this.merge(s,this.settings);},merge:function(s,a){var n,o={};for(n in a)o[n]=a[n];if(s){for(n in s)o[n]=s[n];}return o;},openInIframe:function(iframe_id,form_name,element_names,file_url,js,settings){mox.log('openInIframe: ',iframe_id,form_name,element_names,file_url,js,settings);},open:function(form_name,element_names,file_url,js,settings){mox.log('open: ',form_name,element_names,file_url,js,settings);},filebrowserCallBack:function(field_name,url,type,win){var s;if(typeof(mcFileManager)!="undefined"&&type=="file"){mcFileManager.filebrowserCallBack(field_name,url,type,win);return;}this.field=field_name;this.callerWindow=win;this.inTinyMCE=true;s={path:tinyMCE.getParam("imagemanager_path"),rootpath:tinyMCE.getParam("imagemanager_rootpath"),remember_last_path:tinyMCE.getParam("imagemanager_remember_last_path"),custom_data:tinyMCE.getParam("imagemanager_custom_data"),is_callback:true};this.open(0,field_name,url,mox.bind(this,this.insertFileToTinyMCE),s);},insertFileToTinyMCE:function(url){var url;if(typeof(TinyMCE_convertURL)!="undefined")url=TinyMCE_convertURL(url,null,true);else url=tinyMCE.convertURL(url,null,true);this.callerWindow.document.forms[0].elements[this.field].value=url;try{this.callerWindow.document.forms[0].elements[this.field].onchange();}catch(e){}},selectFile:function(d){this.insertFileToForm(d.url,d);},insertFileToForm:function(url,d){var s=this.callSettings,elements=s.target_elements.split(','),i,elm;if(s.insert_callback)s.insert_callback(url,d);if(s.relative_urls)url=new mox.utils.URL(url).getRelativePath(s.document_base_url);if(s.remove_script_host)url=this.removeHost(url);for(i=0;i<elements.length;i++){elm=document.forms[s.target_form].elements[elements[i]];if(elm&&typeof elm!="undefined")elm.value=url;try{elm.onchange();}catch(e){}}},removeHost:function(url){return url.replace(/^(\w+:\/\/)([^\/]+)/,'');},getArgs:function(){return this.args;},execRPC:function(m,o,c,ec){var ma=this,json=ma.json,s=ma.settings,co=ma.rpcCounter++;json.send(mox.baseURL+'/../rpc/'+(mox.defaultDoc?mox.defaultDoc:''),{method:m,params:[o],id:'c'+co},function(status,response,text){var t,li;if(status!='OK'){ma.onError.dispatch(m,'Critical JSON failure: '+status,null,co,text);return;}if(!response)return;if(response.result)ma.onResult.dispatch(m,response.result,co,text);if(response.error){if(!ec)ma.onError.dispatch(m,response.error,response.result,co,text);else ec(response);return;}switch(typeof(c)){case 'function':c(response,o);break;case 'object':c.processTable(response);break;case 'string':t=new mox.template.GridFill(c);t.process(response);break;}});}});});mox.require([ 'moxiecode.manager.BaseManager'],function(){mox.create('moxiecode.manager.ImageManager:moxiecode.manager.BaseManager',{ImageManager:function(s){this.parent(s);},open:function(form_name,element_names,file_url,js,s){var x,y,w,h,win;s=this.merge(s,this.settings);w=785;h=500;x=parseInt(screen.width / 2.0) - (w / 2.0);y=parseInt(screen.height / 2.0) - (h / 2.0);if(moxiecode.isMSIE){w+=15;h+=35;}this.args={path:s.path,rootpath:s.rootpath,custom_data:s.custom_data,remember_last_path:s.remember_last_path};s.target_form=form_name;s.target_elements=element_names;s.insert_callback=typeof(js)=='function'?js:eval(js);this.callSettings=s;win=window.open(moxiecode.baseURL+'/../index.php?type=im','mcImageManagerWin','left='+x+',top='+y+',width='+w+',height='+h+',scrollbars=yes,resizable=yes,statusbar=no');try{}catch(ex){win.focus();}}});});mox.require([ 'mox.DOM','mox.Event'],function(){var DOM=mox.DOM;var Event=mox.Event;mox.create('static moxiecode.manager.DevKit',{_log:[],init:function(t){this._type=t;Event.add(mox.isIE?document:window,'keyup',function(e){if(e.keyCode==119&&e.ctrlKey&&e.shiftKey){this.show();return Event.cancel(e);}},this);},show:function(){var ifr;if(this._opened)return;ifr=document.body.appendChild(DOM.createTag('iframe',{id:'devkit',frameBorder:'0','class':'devkitdown',style:'display: none;',src:mox.baseURL+'/moxiecode/manager/devkit/devkit.htm'}));DOM.importCSS(mox.baseURL+'/moxiecode/manager/devkit/css/page.css');if(mox.net&&mox.net.JSON)mox.net.JSON.debug=true;this._opened=true;},log:function(){var d=moxiecode.manager.DevKit,a=arguments;if(!d._iframe){if(d._log.length>100)d._log=[];d._log.push(a);}else d._iframe.log(a);}});if(window.console&&window.console.debug)mox.log=window.console.debug;else mox.log=moxiecode.manager.DevKit.log;if(!window.console)window.console={};if(!window.console.debug)window.console.debug=moxiecode.manager.DevKit.log;});